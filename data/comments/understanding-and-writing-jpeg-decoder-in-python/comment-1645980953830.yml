_id: 2006a600-97ee-11ec-9619-81fab9613648
_parent: 'https://yasoob.me/posts/understanding-and-writing-jpeg-decoder-in-python/'
name: gallard
email: f1de37fea49922ab3fa02b7e4e0ea24f
reply_to: 9553d320-900f-11eb-a485-97022966a005
comment: "@kristoff\r\nThe ISO-10918 standard state that the JPEG algorithm is designed for H and W being multiples of 8. If they aren't, the encoder will round them up to the next multiple of 8. These dummy pixels will later be discarded by the decoder.\r\nAbout subsampling:\r\nJPEG includes two stages of compression. One uses DCT and is applied to Y, U and V. The second uses subsampling and is applied to U and V. Yasoob wrote \"... the human eye is pretty bad at seeing high-frequency brightness changes ... \" but it should be \"... high-frequency color change...\". The second stage does not compress luminance (brighness).\r\nFor subsampling, we need to introduce 2 new terms: macroblock (also known as MCU)  and DataUnit (aka DU). A MCU contains some DUs (from 1 to 6 DU, depending on colorFormat). A DU is a 8x8 matrix of compressed Ã©lements.\r\nYUV444 is a format where there is no subsampling. For each Luminance (Y) DataUnit there will one U Chrominance DataUnit and one V Chrominance DataUnit. Thus, the MCU contain 3 DU.\r\nFor YUV400, it will be simpler since there will be no Chrominance DataUnit. The MCU contain 1 DU.\r\nFor YUV422, there is a 2:1 horizontal compression for U and V components. Thus the MCU will contain 4 DU and they will be sequenced YYUV.\r\nFor YUV420, there is a 2:1 compression both horizontally and vertically (resulting in 4:1 compression) for U and V components. The MCU will contain 6 DU and their sequence will be YYYYUVUV.\r\nTo summarize: to decode a JPEG you need to know the ColorFormat (It's supplied in the StartOfScan header (the header is not decoded in Yasoob's program). Then you can read MCUs and extract DUs from them.\r\nOn Linux, there is a command-line tool named mediainfo. It will tell you the colorFormat of a JPEG file."
name_try: ''
date: '2022-02-27T16:55:53.827Z'
